{
  "metadata": {
    "frdId": "FRD-001",
    "title": "Foundation and Contracts",
    "description": "Establish baseline module structure, canonical domain contracts, and deterministic ordering utilities for all MVP review behavior.",
    "status": "in_progress",
    "priority": 1,
    "estimatedEffort": "medium",
    "dependencies": [],
    "specReferences": [
      "specs/mvp-frd-review-spec.md",
      "specs/data-contracts.md",
      "specs/architecture-overview.md"
    ],
    "createdAt": "2026-02-25",
    "updatedAt": "2026-02-28"
  },
  "majorTasks": [
    {
      "taskId": "FRD-001-T0",
      "title": "Add baseline ignore rules",
      "description": "Create a default project .gitignore before any tooling or feature work so generated artifacts do not pollute commits, including Codex PR outputs.",
      "status": "completed",
      "prLevel": true,
      "dependencies": [],
      "subtasks": [
        {
          "subtaskId": "FRD-001-T0-S1",
          "title": "Create Node-focused .gitignore",
          "description": "Add standard Node.js ignore rules covering dependencies, logs, build/test artifacts, caches, local environment files, and `.codex/pr/` outputs.",
          "status": "completed",
          "filesToCreate": [
            ".gitignore"
          ]
        }
      ],
      "gotchas": [
        {
          "id": "FRD-001-T0-G1",
          "severity": "warning",
          "text": "Do not ignore lockfiles or source files required for reproducible builds."
        }
      ],
      "verification": [
        {
          "id": "FRD-001-T0-V1",
          "type": "manual",
          "description": "Confirm git status no longer shows standard local Node artifacts or `.codex/pr/` outputs after install/test runs."
        }
      ],
      "testOmissionReason": "This task is repository hygiene configuration and is validated through git-status behavior rather than executable tests."
    },
    {
      "taskId": "FRD-001-T4",
      "title": "Set up toolchain and dependency baseline",
      "description": "Define environment prerequisites and install core runtime, validation, and test dependencies before feature implementation starts.",
      "status": "completed",
      "prLevel": true,
      "dependencies": [
        "FRD-001-T0"
      ],
      "subtasks": [
        {
          "subtaskId": "FRD-001-T4-S1",
          "title": "Define Node and package-manager baseline",
          "description": "Pick the package manager used by the repo, pin Node version, and document setup commands for local development and CI.",
          "status": "completed",
          "filesToCreate": [
            "docs/development-setup.md",
            ".nvmrc"
          ],
          "filesToModify": [
            "package.json"
          ]
        },
        {
          "subtaskId": "FRD-001-T4-S2",
          "title": "Install schema validation dependencies",
          "description": "Add Ajv v8 and ajv-formats as explicit dependencies to support strict schema compilation and date format checks.",
          "status": "completed",
          "filesToModify": [
            "package.json"
          ]
        },
        {
          "subtaskId": "FRD-001-T4-S3",
          "title": "Install test framework dependencies",
          "description": "Add Vitest, Testing Library, and Playwright dependency set required by FRD-006 quality tasks.",
          "status": "completed",
          "filesToModify": [
            "package.json"
          ]
        },
        {
          "subtaskId": "FRD-001-T4-S4",
          "title": "Add standard scripts for validation and tests",
          "description": "Define package scripts for build, unit, integration, e2e, and schema validation so downstream FRDs can reference stable commands.",
          "status": "completed",
          "filesToModify": [
            "package.json"
          ]
        }
      ],
      "gotchas": [
        {
          "id": "FRD-001-T4-G1",
          "severity": "warning",
          "text": "Keep dependency versions pinned or range-constrained consistently to avoid drift between local and CI environments."
        }
      ],
      "notes": [
        "If a package manager lockfile already exists, use that manager as canonical rather than introducing a second manager."
      ],
      "verification": [
        {
          "id": "FRD-001-T4-V1",
          "type": "manual",
          "description": "A clean checkout can run install, build, and test script discovery commands without missing-package errors."
        }
      ],
      "testOmissionReason": "This task provisions environment and tooling; value is verified by successful install/build/test command execution in downstream tasks rather than dedicated unit tests."
    },
    {
      "taskId": "FRD-001-T1",
      "title": "Create app baseline and module boundaries",
      "description": "Scaffold project structure and module ownership boundaries exactly as architecture-overview requires.",
      "status": "completed",
      "prLevel": true,
      "dependencies": [
        "FRD-001-T4"
      ],
      "subtasks": [
        {
          "subtaskId": "FRD-001-T1-S1",
          "title": "Create domain and UI module directories",
          "description": "Define initial folder structure for ui, domain/review-run, domain/validation, domain/rendering, infra/workers, and types.",
          "status": "completed",
          "filesToCreate": [
            "src/ui/.gitkeep",
            "src/domain/review-run/.gitkeep",
            "src/domain/validation/.gitkeep",
            "src/domain/rendering/.gitkeep",
            "src/infra/workers/.gitkeep",
            "src/types/.gitkeep"
          ]
        },
        {
          "subtaskId": "FRD-001-T1-S2",
          "title": "Document module ownership",
          "description": "Capture module boundaries and allowed dependencies to prevent cross-layer coupling drift.",
          "status": "completed",
          "filesToCreate": [
            "docs/module-boundaries.md"
          ]
        }
      ],
      "gotchas": [
        {
          "id": "FRD-001-T1-G1",
          "severity": "warning",
          "text": "Do not collapse all logic into UI components; domain modules must remain framework-agnostic."
        }
      ],
      "verification": [
        {
          "id": "FRD-001-T1-V1",
          "type": "manual",
          "description": "Confirm created directories map one-to-one with architecture module list."
        }
      ],
      "testRequirements": [
        {
          "id": "FRD-001-T1-TR1",
          "type": "integration",
          "description": "Validate only the highest-risk module-boundary import rules that protect architecture layering.",
          "requiredScenarios": [
            {
              "scenarioId": "FRD-001-T1-TR1-S1",
              "type": "success",
              "description": "A UI module imports domain contracts from src/types and compiles.",
              "expectedOutcome": "Build passes with valid directional dependency usage."
            },
            {
              "scenarioId": "FRD-001-T1-TR1-S2",
              "type": "error",
              "description": "A domain module attempts to import a UI component.",
              "expectedOutcome": "Static check or test fails and flags prohibited dependency direction."
            }
          ]
        }
      ]
    },
    {
      "taskId": "FRD-001-T2",
      "title": "Implement canonical type contracts",
      "description": "Translate data-contracts document into code-level source of truth used by UI and domain modules.",
      "status": "not_started",
      "prLevel": true,
      "dependencies": [
        "FRD-001-T1"
      ],
      "subtasks": [
        {
          "subtaskId": "FRD-001-T2-S1",
          "title": "Add review domain type definitions",
          "description": "Create typed contracts for schema bundles, run issues, file issues, review results, and rendering sections.",
          "status": "not_started",
          "filesToCreate": [
            "src/types/reviewContracts.ts"
          ]
        },
        {
          "subtaskId": "FRD-001-T2-S2",
          "title": "Add contract invariants as executable guards",
          "description": "Define helper predicates for status and summary invariants that can be reused by runtime checks and tests.",
          "status": "not_started",
          "filesToCreate": [
            "src/types/reviewContractGuards.ts"
          ]
        }
      ],
      "verification": [
        {
          "id": "FRD-001-T2-V1",
          "type": "build",
          "description": "TypeScript build succeeds with strict mode and no implicit-any leaks in contract files."
        }
      ],
      "testRequirements": [
        {
          "id": "FRD-001-T2-TR1",
          "type": "unit",
          "description": "Verify critical contract invariants and reject invalid status/summary combinations.",
          "requiredScenarios": [
            {
              "scenarioId": "FRD-001-T2-TR1-S1",
              "type": "success",
              "description": "A status of parse_failed maps to parseOk=false and valid=false in guard checks.",
              "expectedOutcome": "Guard functions return true for valid state combinations."
            },
            {
              "scenarioId": "FRD-001-T2-TR1-S2",
              "type": "error",
              "description": "A status of passed is paired with valid=false.",
              "expectedOutcome": "Guard or assertion reports invariant violation."
            }
          ]
        }
      ]
    },
    {
      "taskId": "FRD-001-T3",
      "title": "Build deterministic ordering helpers",
      "description": "Provide reusable ordering logic for file result sorting and duplicate filename display naming.",
      "status": "not_started",
      "prLevel": false,
      "dependencies": [
        "FRD-001-T2"
      ],
      "subtasks": [
        {
          "subtaskId": "FRD-001-T3-S1",
          "title": "Create status sort priority utility",
          "description": "Implement comparator that enforces parse_failed, validation_failed, passed ordering then uploadIndex tie-break.",
          "status": "not_started",
          "filesToCreate": [
            "src/domain/review-run/sortReviewResults.ts"
          ]
        },
        {
          "subtaskId": "FRD-001-T3-S2",
          "title": "Create display name disambiguation utility",
          "description": "Generate stable user labels for duplicate filenames by upload order index.",
          "status": "not_started",
          "filesToCreate": [
            "src/domain/review-run/disambiguateDisplayName.ts"
          ]
        }
      ],
      "verification": [
        {
          "id": "FRD-001-T3-V1",
          "type": "test",
          "description": "Sorting and display-name helpers return deterministic output across repeated runs."
        }
      ],
      "testRequirements": [
        {
          "id": "FRD-001-T3-TR1",
          "type": "unit",
          "description": "Cover deterministic ordering and duplicate-name disambiguation paths that affect user-visible result stability.",
          "requiredScenarios": [
            {
              "scenarioId": "FRD-001-T3-TR1-S1",
              "type": "success",
              "description": "Three files with mixed statuses are sorted by required status groups and upload index.",
              "expectedOutcome": "Result order matches MVP contract exactly."
            },
            {
              "scenarioId": "FRD-001-T3-TR1-S3",
              "type": "edge",
              "description": "Duplicate filename appears more than twice in one run.",
              "expectedOutcome": "Display labels remain stable and uniquely numbered in upload order."
            }
          ]
        }
      ]
    }
  ]
}
